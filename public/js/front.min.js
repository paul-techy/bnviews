"use strict";var autocomplete="";function print_receipt(){document.getElementById("print-div").classList.add("d-none"),document.getElementById("footer").classList.add("d-none"),window.print(),$("#print-div").removeClass("d-none")}if($(document).on("submit","#accept_reservation_form",(function(){$("#accept_submit").attr("disabled","disabled")})),$("#accept-modal-trigger").on("click",(function(){expirationTimeSet(),$("#accept-modal").modal()})),$(document).on("click","#status",(function(){var e=$(this).attr("data-id"),t=$(this).attr("data-status"),a=APP_URL+"/listing/update_status";$("#messages").empty(),$.ajax({url:a,data:{_token:token,id:e,status:t},type:"post",dataType:"json",success:function(e){$("#status").attr("data-status",e.status),$("#messages").append(""),$("#alert").removeClass("d-none"),$("#messages").append(e.name+" "+hasBeen+" "+e.prop_status+".");var t=$("#alert");setTimeout((function(){t.addClass("d-none")}),4e3)}})})),$(document).on("change","#listing_select",(function(){$("#listing-form").trigger("submit")})),$("#decline-modal-trigger").on("click",(function(){$("#decline-modal").modal()})),$("#discuss-modal-trigger").on("click",(function(){$("#discuss-modal").modal()})),$(document).on("change","#trip_select",(function(){$("#my-trip-form").trigger("submit")})),$(document).on("click",".book_mark_change",(function(e){e.preventDefault();var t=$(this).data("id"),a=$(this).data("status"),n=APP_URL+"/add-edit-book-mark",r=this;if("1"==a)var o=remove;else o=add;""==user_id?window.location.href=BaseURL+"/unauthentication-favourite/"+t:swal({title:o,icon:"warning",buttons:{cancel:{text:no,value:null,visible:!0,className:"btn btn-outline-danger text-16 font-weight-700  pt-3 pb-3 px-5",closeModal:!0},confirm:{text:yes,value:!0,visible:!0,className:"btn vbtn-outline-success text-16 font-weight-700 px-5 pt-3 pb-3 px-5",closeModal:!0}},dangerMode:!0}).then((e=>{e&&$.ajax({url:n,data:{_token:token,id:t,user_id:user_id},type:"post",dataType:"json",success:function(e){$(r).removeData("status"),"Active"==e.favourite.status?($(r).css("color","forestgreen"),$(r).attr("data-status",1),swal(success,added)):($(r).css("color","black"),$(r).attr("data-status",0),swal(success,removed))}})}))})),$("#decline_reason").on("change",(function(){"other"==$("#decline_reason").val()&&$("#cancel_reason_other_div").show()})),void 0===expireTime)var expireTime="";var timer,expiration_time=expireTime,_second=1e3,_minute=60*_second,_hour=60*_minute,_day=24*_hour,expirationTimeSet=function(){};""!==expireTime&&(expirationTimeSet=function(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()).getTime(),a=new Date(expireTime).getTime()-t;if(a<0)return clearInterval(interval),document.getElementById("countdown_1").innerHTML="Expired!";var n=(Math.floor(a/_day),Math.floor(a%_day/_hour)),r=Math.floor(a%_hour/_minute),o=Math.floor(a%_minute/_second);document.getElementById("countdown_1").innerHTML=`${n}h ${r}m ${o}s`});var interval=setInterval(expirationTimeSet,1e3);function set_calendar(e,t){var a=$("#dtpc_property_id").val(),n=APP_URL+"/ajax-calender/"+a;$.ajax({url:n,data:{_token:$('meta[name="csrf-token"]').attr("content"),month:e,year:t},type:"post",dataType:"json",success:function(e){$("#calender-dv").html(e.calendar),$("#hotel_date_package").modal("hide")},error:function(e,t){}})}function dateConvert(e,t){const a={Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12};let n="",r="",o="",s=t.split(/[./-]/g),c=e.split(/[./-]/g);return s.forEach(((e,t)=>{"dd"===e?n=c[t]:"mm"===e?r=c[t]:"M"===e?r=a[c[t]]:e.includes("yy")&&(o=c[t])})),Date.parse(o+"-"+r+"-"+n)}function mapDropDownActive(){document.getElementById("search-drop-down").classList.toggle("sm-show"),$("#header-search-checkin").datepicker("show")}function page_loader_start(){$("body").prepend('<div id="preloader"></div>')}function page_loader_stop(){$("#preloader").fadeOut("slow",(function(){$(this).remove()}))}function modal_alert(e,t){$("#alert_model").modal("show")}function myFunction(){var e=document.getElementById("myInput");e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),document.getElementById("copied").innerHTML="Copied"}$(document).on("change","#calendar_dropdown",(function(){var e=$(this).val(),t=(e=e.split("-"))[0];set_calendar(e[1],t)})),$(document).on("click",".month-nav-next",(function(e){e.preventDefault();var t=$(this).attr("data-year");set_calendar($(this).attr("data-month"),t)})),$(document).on("click",".month-nav-previous",(function(e){e.preventDefault();var t=$(this).attr("data-year");set_calendar($(this).attr("data-month"),t)})),$(document).on("keyup","#header-search-form",(function(){autocomplete=new google.maps.places.Autocomplete(document.getElementById("header-search-form")),google.maps.event.addListener(autocomplete,"place_changed",(function(){mapDropDownActive()}))})),$(document).on("keyup","#sidenav-search-form",(function(){autocomplete=new google.maps.places.Autocomplete(document.getElementById("sidenav-search-form")),google.maps.event.addListener(autocomplete,"place_changed",(function(){document.getElementById("sidenav-search-drop-down").classList.toggle("sm-show"),$("#sidenav-search-checkin").datepicker("show")}))})),$(document).on("keyup","#front-search-field",(function(){autocomplete=new google.maps.places.Autocomplete(document.getElementById("front-search-field"))})),$(document).on("keyup","#location-search-google",(function(){autocomplete=new google.maps.places.Autocomplete(document.getElementById("location-search-google"))})),$(document.body).on("click",".date-package-modal",(function(){$("#model-message").html("");var e=$(this).attr("id").split("-"),t=e[2],a=e[1],n=e[0],r=$(this).attr("data-price"),o=$(this).attr("data-status"),s=$(this).attr("data-minday");t.length<2&&(t="0"+t);var c=t+"-"+a+"-"+n,d=frontDateFormatType;c=$.datepicker.formatDate(d,$.datepicker.parseDate("dd-mm-yy",c)),$("#dtpc_start").val(c),$("#dtpc_end").val(c),$("#dtpc_price").val(r),$("#dtpc_stay").val(s),$("#dtpc_status").val(o).change(),$("#dtpc_start").datepicker({dateFormat:d,onSelect:function(e){var t=$("#dtpc_start").val(),a=$("#dtpc_end").val();$("#error-dtpc-start_date").html(""),$("#error-dtpc-end_date").html(""),dateConvert(t,d)>dateConvert(a,d)&&$("#error-dtpc-start_date").html(startDateError)}}),$("#dtpc_end").datepicker({dateFormat:d,onSelect:function(e){var t=$("#dtpc_start").val(),a=$("#dtpc_end").val();$("#error-dtpc-start").html(""),$("#error-dtpc-end").html(""),dateConvert(t,d)>dateConvert(a,d)&&$("#error-dtpc-end_date").html(endDateError)}}),$("#price_btn").removeClass("disabled"),$("#price_spinner").addClass("d-none"),$("#price_next-text").text(submit),$("#hotel_date_package").modal()})),$(document.body).on("click",".imporpt_calendar",(function(){$("#import_calendar_package").modal()})),$(document.body).on("change","#color",(function(){"custom"==$("#color").val()?$(".colorCustom").css("display","block"):$(".colorCustom").css("display","none")})),$(document.body).on("submit","#icalendar_form",(function(e){e.preventDefault(),$("#error-icalendar-url").html(""),$("#error-icalendar-name").html("");var t=$("#icalendar_url").val(),a=$("#icalendar_name").val(),n=$("#icalendar_property_id").val(),r=$("#color").val(),o=$("#customcolor").val();"custom"==r?""==o&&$("#error-dtpc-customcolor").html(fieldRequiredText):o="none",""==t&&$("#error-icalendar-url").html(fieldRequiredText),""==a&&$("#error-icalendar-name").html(fieldRequiredText),""==r?$("#error-dtpc-color").html(fieldRequiredText):$.ajax({type:"POST",url:APP_URL+"/ajax-icalender-import/"+n,data:{_token:$('meta[name="csrf-token"]').attr("content"),url:t,name:a,property_id:n,color:r,customcolor:o},success:function(e){if(1!=e.status)return $("#error-icalendar-url").html(e.error.url),$("#error-icalendar-name").html(e.error.name),$("#error-dtpc-customcolor").html(e.error.customcolor),!1;$("#icalendar-model-message").html(e.success_message),$("#icalendar-model-message").removeClass("d-none"),$("#import_calendar_package").modal("hide")},error:function(e,t){}})})),$(document.body).on("click","#export_icalendar",(function(){$("#calendar_export_package").modal()})),$(document.body).on("submit","#dtpc_form",(function(e){e.preventDefault(),$("#error-dtpc-start").html(""),$("#error-dtpc-end").html(""),$("#error-dtpc-price").html(""),$("#error-dtpc-status").html(""),$("#error-dtpc-stay").html(""),$("#model-message").html("").removeClass("d-none bg-success bg-danger");var t=$("#dtpc_start").val(),a=$("#dtpc_end").val(),n=$("#dtpc_price").val(),r=$("#dtpc_status").val(),o=$("#dtpc_property_id").val(),s=$("#dtpc_stay").val(),c=APP_URL+"/ajax-calender-price/"+o;""==t&&$("#error-dtpc-start_date").html(startDateBlankError),""==a&&$("#error-dtpc-end_date").html(endDateBlankError),""==n&&$("#error-dtpc-price").html(priceBlankError),""==r&&$("#error-dtpc-status").html(statusBlankError),t&&a&&n&&r&&($("#price_btn").addClass("disabled"),$("#price_spinner").removeClass("d-none"),$("#price_next-text").text(submittingText),$.ajax({type:"POST",url:c,data:{_token:$('meta[name="csrf-token"]').attr("content"),start_date:t,end_date:a,price:n,min_stay:s,status:r},success:function(e){var t=$("#calendar_dropdown").val(),a=(t=t.split("-"))[0];set_calendar(t[1],a),$("#model-message").html(dataSaveMessage).removeClass("d-none bg-danger").addClass("bg-success"),$("#dtpc_form")[0].reset(),$("#hotel_date_package").modal("hide")},error:function(e){if($("#error-dtpc-start_date, #error-dtpc-end_date, #error-dtpc-price, #error-dtpc-status, #error-dtpc-stay").html(""),[400,422].includes(e.status)&&e.responseJSON.errors){let a=e.responseJSON.errors;for(var t in a)$("#error-dtpc-"+t).html(a[t][0])}else{let t=e.responseJSON?.message||errorOccuredMessage;$("#model-message").html(t).removeClass("d-none bg-success").addClass("bg-danger")}$("#price_btn").removeClass("disabled"),$("#price_spinner").addClass("d-none"),$("#price_next-text").text(submit)}}))})),$("#open-review").on("click",(function(){$(".opening-div").addClass("display-off"),$(".review-div").removeClass("display-off")})),$(".icon-click").on("click",(function(){var e=$(this).attr("id"),t=0,a=(e=e.split("-"))[0],n=e[1],r=$("#"+a).val();for($("#"+a).val(n),t=1;t<=r;t++)$("#"+a+"-"+t).removeClass("icon-beach"),$("#"+a+"-"+t).addClass("icon-light-gray");for(t=1;t<=n;t++)$("#"+a+"-"+t).removeClass("icon-light-gray"),$("#"+a+"-"+t).addClass("icon-beach")})),$(".thumb-icon").on("click",(function(){$(".thumb-icon").removeClass("icon-select"),$(".thumb-icon").removeClass("icon-unselect");var e=$(this).attr("data-rel");$("#recommend").attr("value",e),0==e?$(this).addClass("icon-unselect"):$(this).addClass("icon-select")})),$("#guest-form").on("submit",(function(e){e.preventDefault(),$("#save_button").addClass("disabled"),$(".spinner").removeClass("d-none"),$("#save_button_text").text(submit);var t=$("#booking_id").val(),a=$("#review_id").val(),n=$("#review_message").val(),r=$("#secret_feedback").val(),o=$("#cleanliness").val(),s=$("#rating").val(),c=$("#communication").val(),d=$("#house_rules").val(),i=$("#recommend").val(),l=APP_URL+"/reviews/edit/"+t;$.ajax({url:l,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{review_id:a,message:n,secret_feedback:r,cleanliness:o,rating:s,communication:c,house_rules:d,recommend:i},type:"post",dataType:"json",success:function(e){e.success&&(window.location.href=APP_URL+"/users/reviews_by_you")},error:function(e,t){}})})),window.onclick=function(e){if(!(e.target.matches("#search-map")||e.target.matches(".sm-dropdown-content")||$(e.target).parents(".sm-dropdown-content").length||e.target.matches(".ui-state-default")||e.target.matches(".ui-icon")||e.target.matches(".ui-datepicker-month")||e.target.matches(".ui-datepicker-year")||e.target.matches(".month"))){var t,a=document.getElementsByClassName("sm-dropdown-content");for(t=0;t<a.length;t++){var n=a[t];n.classList.contains("sm-show")&&n.classList.remove("sm-show")}}},$(document).on("submit",".search-form",(function(){var t=$("#header-search-checkin").val(),a=$("#header-search-checkout").val(),n=$("#header-search-guests").val(),r=$("#header-search-form").val().replace(" ","+");window.location.href=APP_URL+"/s?location="+r+"&checkin="+t+"&checkout="+a+"&guest="+n,e.preventDefault()})),$("#ok_id").on("click",(function(e){e.preventDefault()})),$(document).on("submit","#front-search-form",(function(){e.preventDefault();var t=$("#startDate").val(),a=$("#endDate").val(),n=$("#front-search-guests").val(),r=$("#front-search-field").val().replace(" ","+");window.location.href=APP_URL+"/search?location="+r+"&checkin="+t+"&checkout="+a+"&guest="+n,e.preventDefault()})),$(document).on("submit",".search-form",(function(e){var t=$("#header-search-checkin").val(),a=$("#header-search-checkout").val(),n=$("#header-search-guests").val(),r=$("#header-search-form").val();if(""==r){t=$("#sidenav-search-checkin").val(),a=$("#sidenav-search-checkout").val(),n=$("#sidenav-search-guests").val();r=$("#sidenav-search-form").val()}c=r.replace(" ","+"),window.location.href=APP_URL+"/search?location="+c+"&checkin="+t+"&checkout="+a+"&guest="+n,e.preventDefault()})),$(".room-list-status").on("change",(function(){var e=$(this).val(),t=$(this).attr("data-room-id");$.ajax({type:"POST",url:APP_URL+"/listing/"+t+"/update_status",data:{_token:"{{ csrf_token() }}",status:e},success:function(){location.reload()}})})),$(document).on("click",".review_detials",(function(){var e=$(this).data("id"),t=$(this).data("name");$("#name").html(t);var a=APP_URL+"/reviews/details";$.ajax({url:a,data:{_token:token,id:e},type:"post",dataType:"text",success:function(e){$("#heading").html(e)}})})),$(document).on("click",".review_detials",(function(){var e=$(this).data("id"),t=$(this).data("name");$("#name").html(t);var a=APP_URL+"/reviews/details";$.ajax({url:a,data:{_token:token,id:e},type:"post",dataType:"text",success:function(e){$("#heading").html(e)}})})),$(document).on("submit","#message-form",(function(e){e.preventDefault();var t=$("#message_text").val();""!=t&&$.ajax({type:"POST",url:APP_URL+"/messaging/qt_reply/"+$("#reservation_id").val(),data:{_token:"{{ csrf_token() }}",message:t},success:function(e){$("#message-list").prepend(e)}})})),$(document).on("submit","#host-message-form",(function(e){e.preventDefault();var t=$("#message_text").val();""!=t&&$.ajax({type:"POST",url:APP_URL+"/messaging/qt_reply/"+$("#reservation_id").val(),data:{_token:"{{ csrf_token() }}",message:t,pricing_room_id:$("#pricing_room_id").val(),pricing_checkin:$("#pricing_start_date").val(),pricing_checkout:$("#pricing_end_date").val(),pricing_guests:1,pricing_price:$("#pricing_price").val()},success:function(e){$("#message-list").prepend(e)}})})),dateRangeBtn(moment(),moment(),null,dateFormat);